import{j as e}from"./ui-vendor-D2IXE4bY.js";import{r,u as C}from"./react-vendor-XYDEKuIS.js";import{g as p,t as M,h as F,i as x,B as S,j as R,k as T,l as b,m as _,n as z,o as j,u as Z,s as y,P as q,p as H}from"./index-0hnW3E_C.js";import{T as V,a as K,f as N}from"./formatters-CvFiryGg.js";import{h as D,a as $}from"./haptic-feedback-C7ikSRXG.js";import{P as I}from"./plus-DXm5Jimi.js";import{R as E,L as O,C as A,X as L,Y as P,T as W,a as U,A as Y,b as G}from"./chart-vendor-CZvqwiTC.js";import{E as J}from"./constants-5iGU4EYx.js";import{i as Q,c as X,a as k}from"./isToday-vAcBv4V4.js";import{S as f}from"./skeleton-DucBJ-c_.js";import{u as ee}from"./use-pull-to-refresh-DXDxZb_V.js";import"./supabase-vendor-DBhEyip2.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=p("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=p("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=p("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);function re(n,t){const o=M(n);return isNaN(t)?F(n,NaN):(o.setDate(o.getDate()+t),o)}function ne(n){return+M(n)<Date.now()}function w(n){return Q(n,re(X(n),1))}const oe={success:{icon:"bg-success-light text-success",iconBg:"bg-success/10",trend:"text-success",border:"border-l-success"},revenue:{icon:"bg-revenue-light text-revenue",iconBg:"bg-revenue/10",trend:"text-success",border:"border-l-revenue"},warning:{icon:"bg-warning-light text-warning",iconBg:"bg-warning/10",trend:"text-warning",border:"border-l-warning"},info:{icon:"bg-info-light text-info",iconBg:"bg-info/10",trend:"text-info",border:"border-l-info"}},g=r.memo(function({title:t,value:o,change:a,icon:l,variant:m,suffix:u,index:h=0}){const d=r.useMemo(()=>oe[m],[m]),s=r.useMemo(()=>a&&a>0,[a]),i=r.useMemo(()=>a&&a<0,[a]),c=r.useMemo(()=>typeof o=="number"?o.toLocaleString("fr-FR"):o,[o]);return e.jsxs("div",{className:x("stat-card border-l-4 transition-all duration-300 hover:shadow-lg hover:-translate-y-1 cursor-default",d.border,"animate-fade-in animate-slide-up"),style:{animationDelay:`${h*100}ms`,animationFillMode:"both"},children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t}),e.jsxs("p",{className:"text-2xl md:text-3xl font-display font-bold text-foreground",children:[c,u&&e.jsx("span",{className:"text-lg font-normal text-muted-foreground ml-1",children:u})]})]}),e.jsx("div",{className:x("stat-icon w-14 h-14 rounded-xl flex items-center justify-center transition-transform duration-300 hover:scale-110",d.iconBg,d.icon),children:e.jsx(l,{className:"h-7 w-7"})})]}),a!==void 0&&e.jsxs("div",{className:x("flex items-center gap-1.5 mt-4 text-sm font-semibold",s&&"text-success",i&&(m==="warning"?"text-success":"text-destructive")),children:[s?e.jsx(V,{className:"h-4 w-4 animate-bounce"}):i?e.jsx(K,{className:"h-4 w-4 animate-bounce"}):null,e.jsx("span",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"animate-pulse",children:[s?"+":"",a,"%"]})})]})]})}),ie=[{label:"Ajouter porc",icon:I,variant:"default",className:"bg-success hover:bg-success/90 text-success-foreground",path:"/pigs?action=add"},{label:"Formuler aliment",icon:R,variant:"default",className:"bg-info hover:bg-info/90 text-info-foreground",path:"/formulator"},{label:"Nouvelle vente",icon:se,variant:"outline",className:"border-revenue text-revenue hover:bg-revenue-light",path:"/finances?action=sale"},{label:"Calendrier",icon:T,variant:"ghost",className:"hover:bg-warning-light text-warning hover:text-warning-foreground",path:"/calendar"}],le=r.memo(function(){const t=C(),o=r.useCallback(a=>{D(),t(a)},[t]);return e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Actions rapides"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ie.map((a,l)=>e.jsxs(S,{variant:a.variant,onClick:()=>o(a.path),className:x("flex flex-col items-center gap-2 h-auto py-4 px-3 transition-all duration-300 hover:scale-105 hover:shadow-lg min-h-[44px]",a.className,"animate-fade-in animate-slide-up"),style:{animationDelay:`${l*100}ms`,animationFillMode:"both"},children:[e.jsx(a.icon,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm font-medium",children:a.label})]},a.label))})]})}),ce=r.memo(function({data:t}){return e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"√âvolution du poids moyen"}),e.jsx("div",{className:"h-64",children:e.jsx(E,{width:"100%",height:"100%",children:e.jsxs(O,{data:t,margin:{top:5,right:20,left:0,bottom:5},children:[e.jsx(A,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(L,{dataKey:"month",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},axisLine:{stroke:"hsl(var(--border))"}}),e.jsx(P,{tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},axisLine:{stroke:"hsl(var(--border))"},unit:" kg"}),e.jsx(W,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"},labelStyle:{color:"hsl(var(--foreground))"}}),e.jsx(U,{type:"monotone",dataKey:"weight",stroke:"hsl(var(--primary))",strokeWidth:3,dot:{fill:"hsl(var(--primary))",strokeWidth:2,r:5},activeDot:{r:7,fill:"hsl(var(--primary))"}})]})})})]})}),de=r.memo(function({data:t}){const o=({active:a,payload:l})=>a&&l&&l.length?e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-1",children:l[0].payload.month}),e.jsxs("p",{className:"text-sm text-success font-medium",children:["Poids moyen: ",e.jsxs("span",{className:"font-bold",children:[l[0].value," kg"]})]})]}):null;return e.jsxs("div",{className:"stat-card",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"√âvolution poids moyen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sur 6 mois"})]}),e.jsx(E,{width:"100%",height:300,children:e.jsxs(Y,{data:t,margin:{top:10,right:10,left:0,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorWeight",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(142, 71%, 45%)",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"hsl(142, 71%, 45%)",stopOpacity:0})]})}),e.jsx(A,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3}),e.jsx(L,{dataKey:"month",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"}}),e.jsx(P,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"},label:{value:"kg",angle:-90,position:"insideLeft",style:{textAnchor:"middle"}}}),e.jsx(W,{content:e.jsx(o,{})}),e.jsx(G,{type:"monotone",dataKey:"weight",stroke:"hsl(142, 71%, 45%)",strokeWidth:3,fill:"url(#colorWeight)",dot:{fill:"hsl(142, 71%, 45%)",r:5,strokeWidth:2,stroke:"hsl(var(--background))"},activeDot:{r:7,strokeWidth:2,stroke:"hsl(142, 71%, 45%)"}})]})})]})}),me=r.memo(function({events:t}){const o=C(),a=r.useCallback(s=>{const i=J.find(c=>c.value===s);return(i==null?void 0:i.icon)||"üìù"},[]),l=r.useCallback(s=>{const i={vaccination:"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",weighing:"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400",birth:"bg-pink-100 text-pink-600 dark:bg-pink-900/30 dark:text-pink-400",sale:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",treatment:"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400",other:"bg-gray-100 text-gray-600 dark:bg-gray-900/30 dark:text-gray-400"};return i[s]||i.other},[]),m=r.useCallback(s=>ne(s)?{label:"Pass√©",variant:"secondary"}:k(s)?{label:"Aujourd'hui",variant:"default"}:w(s)?{label:"Demain",variant:"default"}:{label:"√Ä venir",variant:"outline"},[]),u=r.useCallback(s=>k(s)?"Aujourd'hui":w(s)?"Demain":b(s,"EEEE d MMMM",{locale:j}),[]),h=r.useCallback(()=>{D(),o("/calendar")},[o]),d=r.useMemo(()=>t.slice(0,3),[t]);return e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"√âv√©nements √† venir"}),e.jsxs(S,{variant:"ghost",size:"sm",onClick:h,className:"text-muted-foreground hover:text-foreground min-h-[44px]",children:["Voir tout",e.jsx(_,{className:"h-4 w-4 ml-1"})]})]}),e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Aucun √©v√©nement √† venir"}):d.map((s,i)=>{const c=new Date(s.event_date),v=m(c),B=l(s.event_type);return e.jsxs("div",{className:x("flex items-start gap-3 p-4 rounded-xl bg-muted/30 hover:bg-muted/50 transition-all duration-300 hover:shadow-md cursor-pointer","animate-fade-in animate-slide-up"),style:{animationDelay:`${i*100}ms`,animationFillMode:"both"},children:[e.jsx("div",{className:x("flex flex-col items-center justify-center w-14 h-14 rounded-xl font-bold",B),children:e.jsx("span",{className:"text-2xl leading-none",children:a(s.event_type)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-foreground truncate",children:s.title}),e.jsx(z,{variant:v.variant,className:"text-xs",children:v.label})]}),e.jsxs("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:[u(c)," ‚Ä¢ ",b(c,"HH:mm",{locale:j})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description})]})]},s.id)})})]})});function we(){const{user:n}=Z(),[t,o]=r.useState(null),[a,l]=r.useState([]),[m,u]=r.useState(!0),h=r.useCallback(async()=>{if(n)try{const{count:i}=await y.from("pigs").select("*",{count:"exact",head:!0}).eq("user_id",n.id).eq("status","active"),{data:c}=await y.from("events").select("*").eq("user_id",n.id).gte("event_date",new Date().toISOString()).order("event_date",{ascending:!0}).limit(5);o({totalPigs:i||0,pigsChange:12,monthlyRevenue:24e5,revenueChange:8,feedCost:85e4,feedCostChange:-3,alertsCount:5}),l(c||[])}catch(i){console.error("Error fetching dashboard data:",i)}finally{u(!1)}},[n]),{isPulling:d}=ee({onRefresh:async()=>{$(),u(!0),await h()}});r.useEffect(()=>{h()},[h]);const s=r.useMemo(()=>[{month:"Jan",weight:30},{month:"F√©v",weight:38},{month:"Mar",weight:45},{month:"Avr",weight:52},{month:"Mai",weight:58},{month:"Juin",weight:65}],[]);return m?e.jsxs("div",{className:"content-area space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((i,c)=>e.jsx(f,{className:"h-32 rounded-2xl"},c))}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(f,{className:"h-80 rounded-2xl"}),e.jsx(f,{className:"h-80 rounded-2xl"})]})]}):e.jsxs("div",{className:`content-area space-y-6 transition-transform duration-300 ${d?"translate-y-2":""}`,children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(g,{title:"Total Porcs",value:(t==null?void 0:t.totalPigs)||0,change:t==null?void 0:t.pigsChange,icon:q,variant:"success",index:0}),e.jsx(g,{title:"Revenu mensuel",value:N((t==null?void 0:t.monthlyRevenue)||0),change:t==null?void 0:t.revenueChange,icon:te,variant:"revenue",suffix:"FCFA",index:1}),e.jsx(g,{title:"Co√ªt alimentaire",value:N((t==null?void 0:t.feedCost)||0),change:t==null?void 0:t.feedCostChange,icon:ae,variant:"warning",suffix:"FCFA",index:2}),e.jsx(g,{title:"Alertes",value:(t==null?void 0:t.alertsCount)||0,icon:H,variant:"info",index:3})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(de,{data:s}),e.jsx(le,{})]}),e.jsx("div",{className:"grid lg:grid-cols-1 gap-6",children:e.jsx(ce,{data:s})}),e.jsx(me,{events:a})]})}export{we as default};
