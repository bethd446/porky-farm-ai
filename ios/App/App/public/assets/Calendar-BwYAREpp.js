import{j as e}from"./ui-vendor-D2IXE4bY.js";import{r as h}from"./react-vendor-XYDEKuIS.js";import{g as k,t as d,h as b,u as q,B as f,C as S,b as C,c as E,l as g,m as P,e as w,i as p,n as R,s as B,o as _}from"./index-0hnW3E_C.js";import{E as V}from"./constants-5iGU4EYx.js";import{P as F}from"./plus-DXm5Jimi.js";import{i as O,a as J}from"./isToday-vAcBv4V4.js";import"./supabase-vendor-DBhEyip2.js";import"./chart-vendor-CZvqwiTC.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=k("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);function L(r,t){const n=d(r);if(isNaN(t))return b(r,NaN);if(!t)return n;const o=n.getDate(),c=b(r,n.getTime());c.setMonth(n.getMonth()+t+1,0);const i=c.getDate();return o>=i?c:(n.setFullYear(c.getFullYear(),c.getMonth(),o),n)}function z(r){const t=d(r),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function G(r,t){const n=d(r.start),o=d(r.end);let c=+n>+o;const i=c?+n:+o,l=c?o:n;l.setHours(0,0,0,0);let j=1;const u=[];for(;+l<=i;)u.push(d(l)),l.setDate(l.getDate()+j),l.setHours(0,0,0,0);return c?u.reverse():u}function I(r){const t=d(r);return t.setDate(1),t.setHours(0,0,0,0),t}function K(r,t){const n=d(r),o=d(t);return n.getFullYear()===o.getFullYear()&&n.getMonth()===o.getMonth()}function Q(r,t){return L(r,-t)}function ne(){const{user:r}=q(),[t,n]=h.useState(new Date),[o,c]=h.useState([]),[i,l]=h.useState(null),[j,u]=h.useState(!0);h.useEffect(()=>{(async()=>{if(r)try{const a=I(t),m=z(t),{data:M,error:x}=await B.from("events").select("*").eq("user_id",r.id).gte("event_date",a.toISOString()).lte("event_date",m.toISOString()).order("event_date",{ascending:!0});if(x)throw x;c(M||[])}catch(a){console.error("Error fetching events:",a)}finally{u(!1)}})()},[r,t]);const v=I(t),Y=z(t),A=G({start:v,end:Y}),N=v.getDay(),H=N===0?6:N-1,y=s=>o.filter(a=>O(new Date(a.event_date),s)),D=i?y(i):[],T=s=>{const a=V.find(m=>m.value===s);return(a==null?void 0:a.icon)||"üìù"};return e.jsxs("div",{className:"content-area space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-foreground",children:"Calendrier"}),e.jsx("p",{className:"text-muted-foreground",children:"Planifiez vos √©v√©nements"})]}),e.jsxs(f,{children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Nouvel √©v√©nement"]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs(S,{className:"lg:col-span-2",children:[e.jsx(C,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"capitalize",children:g(t,"MMMM yyyy",{locale:_})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(f,{variant:"outline",size:"icon",onClick:()=>n(Q(t,1)),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"icon",onClick:()=>n(L(t,1)),children:e.jsx(P,{className:"h-4 w-4"})})]})]})}),e.jsxs(w,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(s=>e.jsx("div",{className:"text-center text-sm font-medium text-muted-foreground py-2",children:s},s))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:H}).map((s,a)=>e.jsx("div",{className:"aspect-square"},`pad-${a}`)),A.map(s=>{const a=y(s),m=i&&O(s,i);return e.jsxs("button",{onClick:()=>l(s),className:p("aspect-square p-1 rounded-lg transition-all duration-200","hover:bg-muted/50 flex flex-col items-center justify-start",J(s)&&"bg-primary/10 border border-primary/30",m&&"bg-primary text-primary-foreground",!K(s,t)&&"opacity-30"),children:[e.jsx("span",{className:p("text-sm font-medium",m?"text-primary-foreground":"text-foreground"),children:g(s,"d")}),a.length>0&&e.jsx("div",{className:"flex gap-0.5 mt-1",children:a.slice(0,3).map((M,x)=>e.jsx("div",{className:p("w-1.5 h-1.5 rounded-full",m?"bg-primary-foreground":"bg-primary")},x))})]},s.toISOString())})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(E,{className:"text-lg",children:i?g(i,"d MMMM yyyy",{locale:_}):"S√©lectionnez un jour"})}),e.jsx(w,{children:i?D.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Aucun √©v√©nement ce jour"}),e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Ajouter"]})]}):e.jsx("div",{className:"space-y-3",children:D.map(s=>e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-lg",children:T(s.event_type)}),e.jsx("h4",{className:"font-medium text-foreground",children:s.title})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.cost&&e.jsxs(R,{variant:"secondary",className:"mt-2",children:[s.cost.toLocaleString("fr-FR")," FCFA"]})]},s.id))}):e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:"Cliquez sur un jour pour voir les √©v√©nements"})})]})]})]})}export{ne as default};
