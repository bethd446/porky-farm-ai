import{j as e}from"./ui-vendor-D2IXE4bY.js";import{u as M,r as t}from"./react-vendor-XYDEKuIS.js";import{u as U,L as y,a as Z,C as q,b as G,c as H,d as J,e as K,B as C,f as n}from"./index-0hnW3E_C.js";import{L as m,I as c}from"./label-DZSOZ5Rh.js";import{T as R,a as O,b as E,c as S}from"./tabs-CDvFmIi0.js";import{o as P,s as d,Z as L}from"./types-rH0z_lOS.js";import"./supabase-vendor-DBhEyip2.js";import"./chart-vendor-CZvqwiTC.js";const Q=P({email:d().email("Email invalide"),password:d().min(6,"Le mot de passe doit contenir au moins 6 caractères")}),W=P({fullName:d().min(2,"Le nom doit contenir au moins 2 caractères"),email:d().email("Email invalide"),password:d().min(6,"Le mot de passe doit contenir au moins 6 caractères"),confirmPassword:d()}).refine(u=>u.password===u.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]});function te(){const u=M(),{user:N,signIn:T,signUp:k,loading:g}=U(),[p,l]=t.useState(!1),[a,f]=t.useState({}),[h,F]=t.useState(""),[x,z]=t.useState(""),[v,I]=t.useState(""),[b,$]=t.useState(""),[j,D]=t.useState(""),[w,V]=t.useState("");t.useEffect(()=>{N&&!g&&(console.log("User authenticated, redirecting to dashboard"),u("/dashboard",{replace:!0}))},[N,g,u]);const B=async r=>{r.preventDefault(),f({});try{Q.parse({email:h,password:x}),l(!0);const{error:s}=await T(h,x);if(s){s.message.includes("Invalid login")||s.message.includes("Invalid credentials")?n.error("Email ou mot de passe incorrect"):s.message.includes("password")&&s.message.includes("compromised")?n.error("Ce mot de passe a été compromis dans une fuite de données. Veuillez en choisir un autre."):n.error(s.message),l(!1);return}n.success("Connexion réussie"),await new Promise(i=>setTimeout(i,300))}catch(s){if(s instanceof L){const i={};s.errors.forEach(o=>{o.path[0]&&(i[o.path[0]]=o.message)}),f(i)}l(!1)}},A=async r=>{r.preventDefault(),f({});try{W.parse({fullName:v,email:b,password:j,confirmPassword:w}),l(!0);const{error:s}=await k(b,j,v);if(s){s.message.includes("already registered")||s.message.includes("already exists")?n.error("Cet email est déjà utilisé"):s.message.includes("password")&&(s.message.includes("compromised")||s.message.includes("pwned"))?n.error("Ce mot de passe a été compromis dans une fuite de données. Veuillez en choisir un autre."):s.message.includes("Password")?n.error("Le mot de passe ne respecte pas les critères de sécurité requis"):n.error(s.message),l(!1);return}await new Promise(i=>setTimeout(i,500)),n.success("Compte créé ! Vérifiez votre email pour confirmer votre compte.")}catch(s){if(s instanceof L){const i={};s.errors.forEach(o=>{o.path[0]&&(i[o.path[0]]=o.message)}),f(i)}}finally{l(!1)}};return g?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(y,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 via-background to-primary/10 p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}})]}),e.jsxs("div",{className:"w-full max-w-md relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-8 animate-fade-in",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center shadow-lg hover:scale-110 transition-transform duration-300",children:e.jsx(Z,{className:"h-8 w-8 text-primary-foreground"})}),e.jsx("span",{className:"text-4xl font-display font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"PorcPro"})]}),e.jsxs(q,{className:"border-border/50 shadow-2xl bg-card/95 backdrop-blur-sm animate-scale-in",children:[e.jsxs(G,{className:"text-center pb-6 pt-8",children:[e.jsx(H,{className:"text-3xl font-display bg-gradient-to-r from-foreground to-foreground/70 bg-clip-text text-transparent",children:"Bienvenue"}),e.jsx(J,{className:"text-base mt-2",children:"Gérez votre élevage porcin efficacement"})]}),e.jsx(K,{children:e.jsxs(R,{defaultValue:"login",className:"w-full",children:[e.jsxs(O,{className:"grid w-full grid-cols-2 mb-8 bg-muted/50 p-1",children:[e.jsx(E,{value:"login",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all duration-200",children:"Connexion"}),e.jsx(E,{value:"signup",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground transition-all duration-200",children:"Inscription"})]}),e.jsx(S,{value:"login",className:"space-y-6 animate-fade-in",children:e.jsxs("form",{onSubmit:B,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"login-email",className:"text-sm font-medium",children:"Email"}),e.jsx(c,{id:"login-email",type:"email",placeholder:"vous@exemple.com",value:h,onChange:r=>F(r.target.value),className:`h-11 transition-all duration-200 ${a.email?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.email&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"login-password",className:"text-sm font-medium",children:"Mot de passe"}),e.jsx(c,{id:"login-password",type:"password",placeholder:"••••••••",value:x,onChange:r=>z(r.target.value),className:`h-11 transition-all duration-200 ${a.password?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.password&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.password})]}),e.jsx(C,{type:"submit",className:"w-full h-11 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-lg hover:shadow-xl transition-all duration-200",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Connexion..."]}):"Se connecter"})]})}),e.jsx(S,{value:"signup",className:"space-y-6 animate-fade-in",children:e.jsxs("form",{onSubmit:A,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"signup-name",className:"text-sm font-medium",children:"Nom complet"}),e.jsx(c,{id:"signup-name",placeholder:"Kouassi Jean",value:v,onChange:r=>I(r.target.value),className:`h-11 transition-all duration-200 ${a.fullName?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.fullName&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.fullName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"signup-email",className:"text-sm font-medium",children:"Email"}),e.jsx(c,{id:"signup-email",type:"email",placeholder:"vous@exemple.com",value:b,onChange:r=>$(r.target.value),className:`h-11 transition-all duration-200 ${a.email?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.email&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"signup-password",className:"text-sm font-medium",children:"Mot de passe"}),e.jsx(c,{id:"signup-password",type:"password",placeholder:"••••••••",value:j,onChange:r=>D(r.target.value),className:`h-11 transition-all duration-200 ${a.password?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.password&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"signup-confirm",className:"text-sm font-medium",children:"Confirmer le mot de passe"}),e.jsx(c,{id:"signup-confirm",type:"password",placeholder:"••••••••",value:w,onChange:r=>V(r.target.value),className:`h-11 transition-all duration-200 ${a.confirmPassword?"border-destructive focus-visible:ring-destructive":"focus-visible:ring-primary"}`}),a.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive animate-shake",children:a.confirmPassword})]}),e.jsx(C,{type:"submit",className:"w-full h-11 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-lg hover:shadow-xl transition-all duration-200",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Création..."]}):"Créer un compte"})]})})]})})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6 animate-fade-in",children:["En continuant, vous acceptez nos"," ",e.jsx("a",{href:"#",className:"text-primary hover:underline font-medium",children:"conditions d'utilisation"})]})]})]})}export{te as default};
